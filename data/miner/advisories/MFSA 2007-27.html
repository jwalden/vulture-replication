

<!doctype html>

<html class="windows x86 no-js" lang="en" dir="ltr" data-latest-firefox="52.0" data-esr-versions="45.8.0" data-gtm-container-id="GTM-MW3R8V"  data-stub-attribution-rate="1.0">
  <head>
    <meta charset="utf-8">

    <script type="text/javascript" src="/media/js/site-bundle.1688e984bc3d.js" charset="utf-8"></script>
    

<!--
             _.-~-.
           7''  Q..\
        _7         (_
      _7  _/    _q.  /
    _7 . ___  /VVvv-'_                                            .
   7/ / /~- \_\\      '-._     .-'                      /       //
  ./ ( /-~-/||'=.__  '::. '-~'' {             ___   /  //     ./{
 V   V-~-~| ||   __''_   ':::.   ''~-~.___.-'' _/  // / {_   /  {  /
  VV/-~-~-|/ \ .'__'. '.    '::                     _ _ _        ''.
  / /~~~~||VVV/ /  \ )  \        _ __ ___   ___ ___(_) | | __ _   .::'
 / (~-~-~\\.-' /    \'   \::::. | '_ ` _ \ / _ \_  / | | |/ _` | :::'
/..\    /..\__/      '     '::: | | | | | | (_) / /| | | | (_| | ::'
vVVv    vVVv                 ': |_| |_| |_|\___/___|_|_|_|\__,_| ''

Hi there, nice to meet you!

Interested in having a direct impact on hundreds of millions of users? Join
Mozilla, and become part of a global community that’s helping to build a
brighter future for the Web.

Visit https://careers.mozilla.org to learn about our current job openings.
Visit https://www.mozilla.org/contribute for more ways to get involved and
help support Mozilla.
-->

    <meta name="viewport" content="width=device-width, initial-scale=1">
    

    <title>Unescaped URIs passed to external programs — Mozilla</title>
    <meta name="description" content="">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Mozilla">
    <meta property="og:locale" content="en_US">
    <meta property="og:url" content="https://www.mozilla.org/en-US/security/advisories/mfsa2007-27/">
    <meta property="og:image" content="https://www.mozilla.org/media/img/mozorg/mozilla-256.c29a8b01d659.jpg">
    <meta property="og:title" content="Unescaped URIs passed to external programs">
    <meta property="og:description" content="">
    <meta property="fb:page_id" content="262134952380">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@mozilla">
    <meta name="twitter:domain" content="mozilla.org">
    <meta name="twitter:app:name:googleplay" content="Firefox">
    <meta name="twitter:app:id:googleplay" content="org.mozilla.firefox">
    <meta name="twitter:app:name:iphone" content="Firefox">
    <meta name="twitter:app:id:iphone" content="989804926">
    <meta name="twitter:app:name:ipad" content="Firefox">
    <meta name="twitter:app:id:ipad" content="989804926">
    <link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/media/img/favicon/apple-touch-icon-180x180.8772ec154918.png">
    <link rel="icon" type="image/png" sizes="196x196" href="/media/img/favicon/favicon-196x196.c80e6abe0767.png">
    <link rel="shortcut icon" href="/media/img/favicon.d4f1f46b91f4.ico">
        <link rel="canonical" hreflang="en" href="https://www.mozilla.org/en-US/security/advisories/mfsa2007-27/">
    <link rel="alternate" hreflang="x-default" href="https://www.mozilla.org/security/advisories/mfsa2007-27/">
    <link rel="alternate" hreflang="en" href="https://www.mozilla.org/en-US/security/advisories/mfsa2007-27/" title="English">
    <link rel="alternate" hreflang="en-CA" href="https://www.mozilla.org/en-US/security/advisories/mfsa2007-27/" title="English (Canada)">
    
    

    

    <!--[if lte IE 8]>
      
      <script src="/media/js/libs/html5shiv.d580a4cd1cb4.js"></script>

      
      <link href="/media/css/oldIE-bundle.c95d264ac4d9.css" rel="stylesheet" type="text/css" />
    <![endif]-->

    <!--[if !lte IE 8]><!-->
    
    
      <link href="/media/css/responsive-bundle.ecc928fcc6d0.css" rel="stylesheet" type="text/css" />
    

    
    
  <link href="/media/css/security-bundle.f84f16fb939b.css" rel="stylesheet" type="text/css" />

    <!--<![endif]-->

    
      
    

    

    
    
      <!-- Google Tag Manager -->
<!-- Customized for Mozilla.org-->
<!-- Region Container: NONE -->
<!-- Rollup Container: System Filtered -->
<!-- Site Container: NONE -->


  <script type="text/javascript" src="/media/js/gtm-snippet-bundle.bb4ed1f72aad.js" charset="utf-8"></script>

<!-- End Google Tag Manager -->
    
  </head>

  <body class="html-ltr sand">
    <div id="strings"
      data-global-close="Close"
      data-global-next="Next"
      data-global-previous="Previous"
      data-global-update-firefox="Update your Firefox"
      ></div>
    <div id="outer-wrapper">

    
    

      <div id="wrapper">

      
        <header id="masthead">

        
          <div id="tabzilla">
            <a href="/en-US/" data-link-type="nav" data-link-name="tabzilla">Mozilla</a>
          </div>
        

        
          <nav id="nav-main" role="navigation">
            <span class="toggle" role="button" aria-controls="nav-main-menu" aria-expanded="false" tabindex="0">Menu</span>
            <ul id="nav-main-menu">
              <li class="first internet-health-item">
                <a href="/en-US/internet-health/" data-link-type="nav" data-link-name="Internet Health">Internet Health</a>
              </li>
              <li class="technology-item">
                <a href="/en-US/technology/" data-link-type="nav" data-link-name="Web Innovations">Web Innovations</a>
              </li>
              <li class="last donate-item">
                <a href="https://donate.mozilla.org/en-US/?presets=100,50,25,15&amp;amount=50&amp;ref=EOYFR2015&amp;utm_campaign=EOYFR2015&amp;utm_source=mozilla.org&amp;utm_medium=referral&amp;utm_content=header&amp;currency=usd" data-link-type="nav" data-link-name="Donate">Donate</a>
              </li>
            </ul>
          </nav>
        

        
          <h2><a href="/en-US/"><img class="" src="/media/img/sandstone/header-mozilla-stone.5a157cb2c70c.png" srcset="/media/img/sandstone/header-mozilla-stone-high-res.e61d5c2e5341.png 1.5x" width="170" alt="Mozilla" height="45"></a></h2>
        

        

        

        
  <nav class="breadcrumbs">
    <a href="/en-US/">Home</a> &gt;
    <a href="/en-US/security/">Mozilla Security</a> &gt;
    <a href="/en-US/security/advisories/">Security Advisories</a> &gt;
  </nav>


        

        </header>
      

      
        
      

      
  
  
  <main id="main-content">
    <div class="main-column">
      
  <article class="section-content advisory" itemscope itemtype="http://schema.org/Article">
    <header>
      <h1 itemprop="name" class="title-shadow-box">Mozilla Foundation Security Advisory 2007-27</h1>
    </header>
    <div itemprop="articleBody">

      <h2>Unescaped URIs passed to external programs</h2>

      <dl class="summary">
        
          <dt>Announced</dt>
          <dd>July 30, 2007</dd>
        
        
          <dt>Reporter</dt>
          <dd>Jesper Johansson</dd>
        
        
        
          <dt>Impact</dt>
          <dd><span class="level critical">Critical</span></dd>
        
        <dt>Products</dt>
        <dd>Firefox, SeaMonkey, Thunderbird</dd>
        <dt>Fixed in</dt>
        <dd>
          <ul>
            
              <li>Firefox 2.0.0.6</li>
            
              <li>SeaMonkey 1.1.4</li>
            
              <li>Thunderbird 1.5.0.13</li>
            
              <li>Thunderbird 2.0.0.6</li>
            
          </ul>
        </dd>
        
      </dl>

      <h3>Description</h3>

<p><strong>Jesper Johansson</strong> pointed out that Mozilla did not
percent-encode spaces and double-quotes in URIs handed off to external
programs for handling, which can cause the receiving program to
mistakenly interpret a single URI as multiple arguments. The danger
depends on the arguments supported by the specific receiving program,
though at the very least we know Firefox (and Thunderbird) 2.0.0.4 and
older could be used to run arbitrary script (see
<a href="mfsa2007-23.html">MFSA 2007-23</a>). The vast majority of programs
do not have dangerous arguments, though many could still be made to do
something unexpected.</p>

<p>A similar issue with URIs passed to external handlers was reported by
<strong>Billy Rios</strong> and <strong>Nate McFeters</strong>. When running
Firefox on Windows XP with IE7 installed, URIs for certain
common protocols (such as <code>mailto:</code>) that contain a %00 do not
launch the protocol handler registered for that scheme but instead launch
a file handling program based on the file extension at the end of the URI.
Coupled with the issue reported by Jesper Johansson this appears to allow
execution of any program installed at a known location and limited argument
passing that might be enough to exploit a system.
Further investigation by <strong>Secunia</strong> showed that a % not
followed by a valid two-digit hexadecimal number also triggered the problem
for the affected protocols. The Firefox and Thunderbird 2.0.0.6 releases
contain fixes that prevent the original demonstrations of this variant, but
it is still possible to launch a filetype handler based on extension rather
than the registered protocol handler. A way to exploit a common handler with
a single unexpected URI as an argument may yet be found. Since this handling
is a property of the Windows Shell API this variant appears to affect other
internet-enabled applications that pass these URIs to the Windows Shell.</p>

<h3>Workaround</h3>

<p>By default Firefox will ask before launching external protocol handlers,
and these prompts should be denied from sites that are not trustworthy,
especially if the requested URL contains spaces and double-quote (") characters.
An exception is made for mail-related protocols in Firefox, they do not prompt
by default. If the default mail handler is Thunderbird 2.0.0.5 or later there
will not be a problem, but if another program or older version of Thunderbird
is the default handler then mail URIs can be made to prompt as well. (Similarly,
in Thunderbird browser protocols like <code>http:</code> and <code>ftp:</code>
do not prompt but instead launch the default browser.) To make mail-related
links prompt in Firefox before launching external programs:</p>

<ul>
<li>Enter <kbd>about:config</kbd> in the location bar</li>
<li>Enter <kbd>warn-external</kbd> in the <samp>Filter:</samp> box</li>
<li>Double-click to set the mailto, news, nntp, and snews lines to <samp>true</samp></li>
</ul>

<h3>References</h3>

<ul>
<li><a class="ex-ref" href="http://msinfluentials.com/blogs/jesper/archive/2007/07/20/hey-mozilla-quotes-are-not-legal-in-a-url.aspx">
Jesper's Blog</a></li>
<li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=389106">
https://bugzilla.mozilla.org/show_bug.cgi?id=389106</a></li>
<li><a class="ex-ref" href="http://nvd.nist.gov/nvd.cfm?cvename=CVE-2007-3845">CVE-2007-3845</a></li>
<li>Secunia Advisory <a class="ex-ref" href="http://secunia.com/advisories/26201/">SA26201</a></li>
<li><abbr title="United States Computer Emergency Readiness Team">US-CERT</abbr> Vulnerability Notes <a class="ex-ref" href="http://www.kb.cert.org/vuls/id/783400">VU#783400</a>
and <a class="ex-ref" href="http://www.kb.cert.org/vuls/id/403150">VU##403150</a></li>
<li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=389580">
https://bugzilla.mozilla.org/show_bug.cgi?id=389580</a></li>
</ul>
    </div>
  </article>

    </div>
    
      <aside class="sidebar">
        
          <nav>
            <ul>
            
              <li>
              
                <a href="/en-US/security/">Mozilla Security</a>
              
              </li>
            
              <li>
              
                <a href="/en-US/security/advisories/">Security Advisories</a>
              
              </li>
            
              <li>
              
                <a href="/en-US/security/known-vulnerabilities/">Known Vulnerabilities</a>
              
              </li>
            
              <li>
              
                <a href="/en-US/security/bug-bounty/">Bug Bounty</a>
              
              </li>
            
              <li>
              
                <a href="/en-US/security/bug-bounty/hall-of-fame/">Firefox Hall Of Fame</a>
              
              </li>
            
              <li>
              
                <a href="/en-US/security/bug-bounty/web-hall-of-fame/">Mozilla Web and Services Hall Of Fame</a>
              
              </li>
            
              <li>
              
                <a href="https://blog.mozilla.com/security/">Security Blog</a>
              
              </li>
            
            </ul>
          </nav>
        
        
        
      </aside>
    
  </main>


      

      </div><!-- close #wrapper -->

      
      

      
              <footer id="colophon" class="">
        <nav class="row">
          <div class="col col-1">
            <div class="logo"><a href="/en-US/" data-link-type="footer" data-link-name="Mozilla">Mozilla</a></div>
            <p class="license">Portions of this content are ©1998–2017 by individual mozilla.org contributors. Content available under a <a href="/en-US/foundation/licensing/website-content/">Creative Commons license</a>.</p>
          </div>
          <div class="col col-2">
            <ul class="links-join">
              <li><a href="/en-US/about/" data-link-type="footer" data-link-name="About">About</a></li>
              <li class="wrap"><a href="/en-US/contact/" data-link-type="footer" data-link-name="Contact Us">Contact Us</a></li>
              <li class="wrap"><a href="https://donate.mozilla.org/en-US/?presets=100,50,25,15&amp;amount=50&amp;ref=EOYFR2015&amp;utm_campaign=EOYFR2015&amp;utm_source=mozilla.org&amp;utm_medium=referral&amp;utm_content=footer&amp;currency=usd" class="donate" data-link-type="footer" data-link-name="Donate">Donate</a></li>
              <li class="clear"><a href="https://wiki.mozilla.org/Webdev/GetInvolved/mozilla.org" data-link-type="footer" data-link-name="Contribute to this site">Contribute to this site</a></li>
            </ul>

            

            <ul class="links-legal">
              <li><a href="/en-US/privacy/" data-link-type="footer" data-link-name="Privacy">Privacy</a></li>
              <li class="wrap"><a href="/en-US/privacy/websites/#cookies" data-link-type="footer" data-link-name="Cookies">Cookies</a></li>
              <li class="wrap"><a href="/en-US/about/legal/" data-link-type="footer" data-link-name="Legal">Legal</a></li>
              <li class="clear"><a href="/en-US/about/legal/fraud-report/" data-link-type="footer" data-link-name="Report Trademark Abuse">Report Trademark Abuse</a></li>
            </ul>
          </div>
          <div class="col col-3">
            <ul class="links-social">
              <li>
                Mozilla:
                <ul>
                  <li><a href="https://twitter.com/mozilla" data-link-type="footer" data-link-name="Twitter (@mozilla)">Twitter<span> (@mozilla)</span></a></li>
                  <li><a href="https://www.facebook.com/mozilla" data-link-type="footer" data-link-name="Facebook (Mozilla)">Facebook<span> (Mozilla)</span></a></li>
                  <li><a href="https://www.instagram.com/mozillagram/" data-link-type="footer" data-link-name="Instagram (@mozillagram)">Instagram<span> (@mozillagram)</span></a></li>
                </ul>
              </li>
              <li>
                Firefox:
                <ul>
                  <li><a href="https://twitter.com/firefox" data-link-type="footer" data-link-name="Twitter (@firefox)">Twitter<span> (@firefox)</span></a></li>
                  <li><a href="https://www.facebook.com/Firefox" data-link-type="footer" data-link-name="Facebook (Firefox)">Facebook<span> (Firefox)</span></a></li>
                  <li><a href="https://www.youtube.com/firefoxchannel" data-link-type="footer" data-link-name="YouTube (firefoxchannel)">YouTube<span> (firefoxchannel)</span></a></li>
                </ul>
              </li>
            </ul>
            <div class="lang-switcher">
              
            </div>
          </div>
        </nav>
      </footer>
      

    </div><!-- close #outer-wrapper -->

    <!--[if IE 9]>
      <script src="/media/js/libs/matchMedia.3fd01d1af18b.js"></script>
    <![endif]-->

    
      <script type="text/javascript" src="/media/js/common-bundle.fef29294f735.js" charset="utf-8"></script>
    

    
    
      
        <script type="text/javascript" src="/media/js/stub-attribution-bundle.24a3d38f42a0.js" charset="utf-8"></script>
      
    

    

    
  </body>
</html>