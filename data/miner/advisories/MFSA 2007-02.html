

<!doctype html>

<html class="windows x86 no-js" lang="en" dir="ltr" data-latest-firefox="52.0" data-esr-versions="45.8.0" data-gtm-container-id="GTM-MW3R8V"  data-stub-attribution-rate="1.0">
  <head>
    <meta charset="utf-8">

    <script type="text/javascript" src="/media/js/site-bundle.1688e984bc3d.js" charset="utf-8"></script>
    

<!--
             _.-~-.
           7''  Q..\
        _7         (_
      _7  _/    _q.  /
    _7 . ___  /VVvv-'_                                            .
   7/ / /~- \_\\      '-._     .-'                      /       //
  ./ ( /-~-/||'=.__  '::. '-~'' {             ___   /  //     ./{
 V   V-~-~| ||   __''_   ':::.   ''~-~.___.-'' _/  // / {_   /  {  /
  VV/-~-~-|/ \ .'__'. '.    '::                     _ _ _        ''.
  / /~~~~||VVV/ /  \ )  \        _ __ ___   ___ ___(_) | | __ _   .::'
 / (~-~-~\\.-' /    \'   \::::. | '_ ` _ \ / _ \_  / | | |/ _` | :::'
/..\    /..\__/      '     '::: | | | | | | (_) / /| | | | (_| | ::'
vVVv    vVVv                 ': |_| |_| |_|\___/___|_|_|_|\__,_| ''

Hi there, nice to meet you!

Interested in having a direct impact on hundreds of millions of users? Join
Mozilla, and become part of a global community that’s helping to build a
brighter future for the Web.

Visit https://careers.mozilla.org to learn about our current job openings.
Visit https://www.mozilla.org/contribute for more ways to get involved and
help support Mozilla.
-->

    <meta name="viewport" content="width=device-width, initial-scale=1">
    

    <title>Improvements to help protect against Cross-Site Scripting attacks — Mozilla</title>
    <meta name="description" content="">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Mozilla">
    <meta property="og:locale" content="en_US">
    <meta property="og:url" content="https://www.mozilla.org/en-US/security/advisories/mfsa2007-02/">
    <meta property="og:image" content="https://www.mozilla.org/media/img/mozorg/mozilla-256.c29a8b01d659.jpg">
    <meta property="og:title" content="Improvements to help protect against Cross-Site Scripting attacks">
    <meta property="og:description" content="">
    <meta property="fb:page_id" content="262134952380">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@mozilla">
    <meta name="twitter:domain" content="mozilla.org">
    <meta name="twitter:app:name:googleplay" content="Firefox">
    <meta name="twitter:app:id:googleplay" content="org.mozilla.firefox">
    <meta name="twitter:app:name:iphone" content="Firefox">
    <meta name="twitter:app:id:iphone" content="989804926">
    <meta name="twitter:app:name:ipad" content="Firefox">
    <meta name="twitter:app:id:ipad" content="989804926">
    <link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/media/img/favicon/apple-touch-icon-180x180.8772ec154918.png">
    <link rel="icon" type="image/png" sizes="196x196" href="/media/img/favicon/favicon-196x196.c80e6abe0767.png">
    <link rel="shortcut icon" href="/media/img/favicon.d4f1f46b91f4.ico">
        <link rel="canonical" hreflang="en" href="https://www.mozilla.org/en-US/security/advisories/mfsa2007-02/">
    <link rel="alternate" hreflang="x-default" href="https://www.mozilla.org/security/advisories/mfsa2007-02/">
    <link rel="alternate" hreflang="en" href="https://www.mozilla.org/en-US/security/advisories/mfsa2007-02/" title="English">
    <link rel="alternate" hreflang="en-CA" href="https://www.mozilla.org/en-US/security/advisories/mfsa2007-02/" title="English (Canada)">
    
    

    

    <!--[if lte IE 8]>
      
      <script src="/media/js/libs/html5shiv.d580a4cd1cb4.js"></script>

      
      <link href="/media/css/oldIE-bundle.c95d264ac4d9.css" rel="stylesheet" type="text/css" />
    <![endif]-->

    <!--[if !lte IE 8]><!-->
    
    
      <link href="/media/css/responsive-bundle.ecc928fcc6d0.css" rel="stylesheet" type="text/css" />
    

    
    
  <link href="/media/css/security-bundle.f84f16fb939b.css" rel="stylesheet" type="text/css" />

    <!--<![endif]-->

    
      
    

    

    
    
      <!-- Google Tag Manager -->
<!-- Customized for Mozilla.org-->
<!-- Region Container: NONE -->
<!-- Rollup Container: System Filtered -->
<!-- Site Container: NONE -->


  <script type="text/javascript" src="/media/js/gtm-snippet-bundle.bb4ed1f72aad.js" charset="utf-8"></script>

<!-- End Google Tag Manager -->
    
  </head>

  <body class="html-ltr sand">
    <div id="strings"
      data-global-close="Close"
      data-global-next="Next"
      data-global-previous="Previous"
      data-global-update-firefox="Update your Firefox"
      ></div>
    <div id="outer-wrapper">

    
    

      <div id="wrapper">

      
        <header id="masthead">

        
          <div id="tabzilla">
            <a href="/en-US/" data-link-type="nav" data-link-name="tabzilla">Mozilla</a>
          </div>
        

        
          <nav id="nav-main" role="navigation">
            <span class="toggle" role="button" aria-controls="nav-main-menu" aria-expanded="false" tabindex="0">Menu</span>
            <ul id="nav-main-menu">
              <li class="first internet-health-item">
                <a href="/en-US/internet-health/" data-link-type="nav" data-link-name="Internet Health">Internet Health</a>
              </li>
              <li class="technology-item">
                <a href="/en-US/technology/" data-link-type="nav" data-link-name="Web Innovations">Web Innovations</a>
              </li>
              <li class="last donate-item">
                <a href="https://donate.mozilla.org/en-US/?presets=100,50,25,15&amp;amount=50&amp;ref=EOYFR2015&amp;utm_campaign=EOYFR2015&amp;utm_source=mozilla.org&amp;utm_medium=referral&amp;utm_content=header&amp;currency=usd" data-link-type="nav" data-link-name="Donate">Donate</a>
              </li>
            </ul>
          </nav>
        

        
          <h2><a href="/en-US/"><img class="" src="/media/img/sandstone/header-mozilla-stone.5a157cb2c70c.png" srcset="/media/img/sandstone/header-mozilla-stone-high-res.e61d5c2e5341.png 1.5x" width="170" alt="Mozilla" height="45"></a></h2>
        

        

        

        
  <nav class="breadcrumbs">
    <a href="/en-US/">Home</a> &gt;
    <a href="/en-US/security/">Mozilla Security</a> &gt;
    <a href="/en-US/security/advisories/">Security Advisories</a> &gt;
  </nav>


        

        </header>
      

      
        
      

      
  
  
  <main id="main-content">
    <div class="main-column">
      
  <article class="section-content advisory" itemscope itemtype="http://schema.org/Article">
    <header>
      <h1 itemprop="name" class="title-shadow-box">Mozilla Foundation Security Advisory 2007-02</h1>
    </header>
    <div itemprop="articleBody">

      <h2>Improvements to help protect against Cross-Site Scripting attacks</h2>

      <dl class="summary">
        
          <dt>Announced</dt>
          <dd>February 23, 2007</dd>
        
        
          <dt>Reporter</dt>
          <dd>various</dd>
        
        
        
          <dt>Impact</dt>
          <dd><span class="level low">Low</span></dd>
        
        <dt>Products</dt>
        <dd>Firefox, SeaMonkey</dd>
        <dt>Fixed in</dt>
        <dd>
          <ul>
            
              <li>Firefox 1.5.0.10</li>
            
              <li>Firefox 2.0.0.2</li>
            
              <li>SeaMonkey 1.0.8</li>
            
          </ul>
        </dd>
        
      </dl>

      <p>Firefox 2.0.0.2 and 1.5.0.10 contain several small changes that will 
make it easier for sites to protect their visitors against 
<dfn>Cross-Site Scripting (XSS)</dfn> attacks.</p>

<h4>Invalid trailing characters in HTML tag attributes</h4>

<p>The Mozilla parser formerly ignored invalid trailing characters in
HTML tag attribute names. This could in some cases be abused to evade
web sites content filters that attempted to remove problematic attributes
such as event handlers. If the content filters matched attributes using
a regular expression that expected to find trailing whitespace or one of 
a small set of delimiters.</p>

<p>The new behavior is not to consider these characters as delimiters, instead
they form part of a longer invalid attribute name, no longer allowing
expressions such as <code>onload..="doEvil();"</code> to work.</p>

<ul>
<li><a class="ex-ref" href="http://nvd.nist.gov/nvd.cfm?cvename=CVE-2007-0995">CVE-2007-0995</a></li>
<li><a class="ex-ref" href="http://ha.ckers.org/xss.html#XSS_Non_alpha_non_digit2">
http://ha.ckers.org/xss.html#XSS_Non_alpha_non_digit2</a></li>
<li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=314980">
https://bugzilla.mozilla.org/show_bug.cgi?id=314980</a></li>
<li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=315473">
https://bugzilla.mozilla.org/show_bug.cgi?id=315473</a></li>
</ul>

<h4>Child frame character set inheritance</h4>

<p>Documents on the "World Wide" Web should specify the character set being
used either in the document itself or in an HTTP header sent by the server.
In practice, however, many sites do not do this and browsers have had to
make assumptions. One of those assumptions was that if not otherwise
specified a child frame should inherit the character set of its parent
window rather than the default used for top level pages (which is generally
taken from the user's locale settings).</p>

<p>Stefan Esser demonstrated that this could be used for XSS attacks against
sites that accept user content and do not specify the character set
or encoding used. In this case an attack could be constructed by first
injecting script tags into the victim site encoded as UTF-7 which is unlikely
to be caught by filters since it does not contain the tell-tale angle-brackets.
Then the page with the injected content (which could be something as innocuous
as a blog comment) would be loaded in an <code>iframe</code> on the
malicious site that specifies its encoding as UTF-7. When a user views
the malicious page the injected content will run scripts in the context of
the victim site.</p>

<p>The new behavior is to use the same default encoding or character set we
would for top-level windows, unless the parent content comes from the same
site as the child frame.</p>

<ul>
<li><a class="ex-ref" href="http://nvd.nist.gov/nvd.cfm?cvename=CVE-2007-0996">CVE-2007-0996</a></li>
<li><a class="ex-ref" href="http://www.hardened-php.net/advisory_032007.142.html">
Hardened-PHP Project Advisory 03/2007: Multiple Browsers Cross Domain Charset Inheritance Vulnerability</a></li>
<li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=356280">
https://bugzilla.mozilla.org/show_bug.cgi?id=356280</a></li>
</ul>

<h4>Injected password forms</h4>

<p>MySpace users recently suffered a phishing attack where user-created
content included a login form that appeared to be a normal MySpace
login, but was altered to submit the data to an alternate site. Because
the password form appeared on a MySpace page the Firefox password manager
filled in the saved password, lending an air of legitimacy to the
form. Note that even without the password manager many users of other
browsers were fooled into manually typing in their password, and MySpace
has since stopped allowing password fields as part of user-contributed
content.</p>

<p>The Firefox password manager was altered to take into account the destination
site of the password data and only replay when a form's destination matches
the one that was saved. This does not protect users if an attacker was
able to inject script into the site in addition to form controls as the
injected script could listen in on anything the user does.</p>

<ul>
<li><a class="ex-ref" href="http://nvd.nist.gov/nvd.cfm?cvename=CVE-2006-6077">CVE-2006-6077</a></li>
<li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=360493">
https://bugzilla.mozilla.org/show_bug.cgi?id=360493</a></li>
</ul>

<h4>Adobe Reader universal XSS</h4>

<p>Stefano Di Paola disclosed a "universal cross-site scripting" attack through
Adobe Reader at the 23rd Chaos Communication Congress.
This vulnerability (CVE-2007-0045) can be used against any site hosting a .pdf document
and affects users with versions of Adobe Reader 7.0.8 or below.</p>

<p>Users who have an older versions can protect themselves from this and other
vulnerabilities by upgrading to 
<a class="ex-ref" href="http://www.adobe.com/">Adobe Reader 8</a>.
To help protect our users who are not aware of this need to upgrade
we have blocked requests of this type from Adobe Reader.</p>

<ul>
<li><a class="ex-ref" href="http://www.wisec.it/vulns.php?page=9">http://www.wisec.it/vulns.php?page=9</a></li>
<li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=366082">
https://bugzilla.mozilla.org/show_bug.cgi?id=366082</a></li>
</ul>
    </div>
  </article>

    </div>
    
      <aside class="sidebar">
        
          <nav>
            <ul>
            
              <li>
              
                <a href="/en-US/security/">Mozilla Security</a>
              
              </li>
            
              <li>
              
                <a href="/en-US/security/advisories/">Security Advisories</a>
              
              </li>
            
              <li>
              
                <a href="/en-US/security/known-vulnerabilities/">Known Vulnerabilities</a>
              
              </li>
            
              <li>
              
                <a href="/en-US/security/bug-bounty/">Bug Bounty</a>
              
              </li>
            
              <li>
              
                <a href="/en-US/security/bug-bounty/hall-of-fame/">Firefox Hall Of Fame</a>
              
              </li>
            
              <li>
              
                <a href="/en-US/security/bug-bounty/web-hall-of-fame/">Mozilla Web and Services Hall Of Fame</a>
              
              </li>
            
              <li>
              
                <a href="https://blog.mozilla.com/security/">Security Blog</a>
              
              </li>
            
            </ul>
          </nav>
        
        
        
      </aside>
    
  </main>


      

      </div><!-- close #wrapper -->

      
      

      
              <footer id="colophon" class="">
        <nav class="row">
          <div class="col col-1">
            <div class="logo"><a href="/en-US/" data-link-type="footer" data-link-name="Mozilla">Mozilla</a></div>
            <p class="license">Portions of this content are ©1998–2017 by individual mozilla.org contributors. Content available under a <a href="/en-US/foundation/licensing/website-content/">Creative Commons license</a>.</p>
          </div>
          <div class="col col-2">
            <ul class="links-join">
              <li><a href="/en-US/about/" data-link-type="footer" data-link-name="About">About</a></li>
              <li class="wrap"><a href="/en-US/contact/" data-link-type="footer" data-link-name="Contact Us">Contact Us</a></li>
              <li class="wrap"><a href="https://donate.mozilla.org/en-US/?presets=100,50,25,15&amp;amount=50&amp;ref=EOYFR2015&amp;utm_campaign=EOYFR2015&amp;utm_source=mozilla.org&amp;utm_medium=referral&amp;utm_content=footer&amp;currency=usd" class="donate" data-link-type="footer" data-link-name="Donate">Donate</a></li>
              <li class="clear"><a href="https://wiki.mozilla.org/Webdev/GetInvolved/mozilla.org" data-link-type="footer" data-link-name="Contribute to this site">Contribute to this site</a></li>
            </ul>

            

            <ul class="links-legal">
              <li><a href="/en-US/privacy/" data-link-type="footer" data-link-name="Privacy">Privacy</a></li>
              <li class="wrap"><a href="/en-US/privacy/websites/#cookies" data-link-type="footer" data-link-name="Cookies">Cookies</a></li>
              <li class="wrap"><a href="/en-US/about/legal/" data-link-type="footer" data-link-name="Legal">Legal</a></li>
              <li class="clear"><a href="/en-US/about/legal/fraud-report/" data-link-type="footer" data-link-name="Report Trademark Abuse">Report Trademark Abuse</a></li>
            </ul>
          </div>
          <div class="col col-3">
            <ul class="links-social">
              <li>
                Mozilla:
                <ul>
                  <li><a href="https://twitter.com/mozilla" data-link-type="footer" data-link-name="Twitter (@mozilla)">Twitter<span> (@mozilla)</span></a></li>
                  <li><a href="https://www.facebook.com/mozilla" data-link-type="footer" data-link-name="Facebook (Mozilla)">Facebook<span> (Mozilla)</span></a></li>
                  <li><a href="https://www.instagram.com/mozillagram/" data-link-type="footer" data-link-name="Instagram (@mozillagram)">Instagram<span> (@mozillagram)</span></a></li>
                </ul>
              </li>
              <li>
                Firefox:
                <ul>
                  <li><a href="https://twitter.com/firefox" data-link-type="footer" data-link-name="Twitter (@firefox)">Twitter<span> (@firefox)</span></a></li>
                  <li><a href="https://www.facebook.com/Firefox" data-link-type="footer" data-link-name="Facebook (Firefox)">Facebook<span> (Firefox)</span></a></li>
                  <li><a href="https://www.youtube.com/firefoxchannel" data-link-type="footer" data-link-name="YouTube (firefoxchannel)">YouTube<span> (firefoxchannel)</span></a></li>
                </ul>
              </li>
            </ul>
            <div class="lang-switcher">
              
            </div>
          </div>
        </nav>
      </footer>
      

    </div><!-- close #outer-wrapper -->

    <!--[if IE 9]>
      <script src="/media/js/libs/matchMedia.3fd01d1af18b.js"></script>
    <![endif]-->

    
      <script type="text/javascript" src="/media/js/common-bundle.fef29294f735.js" charset="utf-8"></script>
    

    
    
      
        <script type="text/javascript" src="/media/js/stub-attribution-bundle.24a3d38f42a0.js" charset="utf-8"></script>
      
    

    

    
  </body>
</html>